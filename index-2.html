<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>감사한달 캠페인</title>
    <style>
        :root {
            --primary-color: #ff6b35;
            --secondary-color: #ff9a56;
            --accent-color: #22c55e;
            --text-color: #333;
            --bg-color: #fff7ed;
            --card-bg: white;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }

        body {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            text-align: center;
            padding: 40px 20px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .countdown {
            background: var(--card-bg);
            color: var(--text-color);
            padding: 30px;
            border-radius: var(--border-radius);
            margin: 20px auto;
            max-width: 500px;
        }
        
        .countdown h2 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .time-boxes {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .time-box {
            color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            min-width: 60px;
            transition: var(--transition);
        }
        
        .time-box:hover, .time-box:focus {
            transform: scale(1.05);
            outline: 2px solid var(--accent-color);
        }
        
        .time-box:nth-child(1) { background: #f97316; }
        .time-box:nth-child(2) { background: #ef4444; }
        .time-box:nth-child(3) { background: #eab308; }
        .time-box:nth-child(4) { background: var(--accent-color); }
        
        .time-number {
            font-size: 1.8rem;
            font-weight: bold;
            display: block;
        }
        
        .time-label {
            font-size: 0.9rem;
        }
        
        .card {
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .card:hover, .card:focus-within {
            transform: translateY(-5px);
        }
        
        .section-title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
            color: var(--text-color);
        }
        
        .overview-text {
            font-size: 1.1rem;
            line-height: 1.7;
            text-align: center;
        }
        
        .highlight {
            background: var(--bg-color);
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .steps {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 30px;
        }
        
        .step {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .step:hover, .step:focus-within {
            transform: translateY(-5px);
        }
        
        .step-number {
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 15px;
        }
        
        .schedule {
            background: linear-gradient(135deg, var(--primary-color), #d63031);
            color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            text-align: center;
        }
        
        .schedule-items {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .schedule-item {
            text-align: center;
            padding: 20px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .schedule-item:hover, .schedule-item:focus {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
        }
        
        .schedule-date {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .info-box {
            background: #eff6ff;
            border-left: 4px solid #60a5fa;
            padding: 20px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            text-align: center;
            color: #1e40af;
            font-weight: 500;
        }
        
        .gratitude-form {
            background: linear-gradient(135deg, var(--primary-color), #d63031);
            color: white;
            padding: 30px;
            border-radius: var(--border-radius);
        }
        
        .form-title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .form-subtitle {
            text-align: center;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .form-input, .form-textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            box-sizing: border-box;
        }
        
        .form-textarea {
            height: 100px;
            resize: vertical;
        }
        
        .submit-btn {
            width: 100%;
            background: var(--card-bg);
            color: var(--primary-color);
            padding: 15px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .submit-btn:hover, .submit-btn:focus {
            background: #f9f9f9;
            outline: 2px solid var(--accent-color);
        }
        
        .shared-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-top: 30px;
        }
        
        .gratitude-list {
            margin-top: 20px;
        }
        
        .gratitude-item {
            background: rgba(255,255,255,0.95);
            color: var(--text-color);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            transition: var(--transition);
        }
        
        .gratitude-item:hover, .gratitude-item:focus-within {
            background: var(--card-bg);
            transform: translateX(10px);
        }
        
        .gratitude-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .user-name {
            font-weight: bold;
        }
        
        .gratitude-text {
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .gratitude-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #666;
        }
        
        .like-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .like-btn:hover, .like-btn:focus {
            color: var(--primary-color);
            outline: 2px solid var(--accent-color);
        }
        
        .load-more-btn {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .load-more-btn:hover, .load-more-btn:focus {
            background: #e65a2e;
            outline: 2px solid var(--accent-color);
        }
        
        .footer {
            background: #1f2937;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 50px;
        }
        
        .footer-verse {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--accent-color);
            color: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            display: none;
            z-index: 1000;
        }
        
        .notification.show {
            display: block;
        }
        
        .nav-menu {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 10px 0;
            z-index: 1000;
            min-width: 100px;
        }
        
        .nav-item {
            display: block;
            padding: 8px 15px;
            color: #666;
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        
        .nav-item:hover, .nav-item:focus {
            background: var(--primary-color);
            color: white;
            outline: none;
        }
        
        .nav-item.active {
            background: var(--primary-color);
            color: white;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .time-boxes {
                justify-content: center;
            }
            
            .schedule-items {
                flex-direction: column;
                gap: 15px;
            }
            
            .steps {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .nav-menu {
                right: 10px;
                min-width: 80px;
            }
            
            .nav-item {
                font-size: 0.8rem;
                padding: 6px 10px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .title {
                font-size: 1.8rem;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .steps {
                grid-template-columns: 1fr;
            }
            
            .submit-btn, .load-more-btn {
                padding: 12px;
                font-size: 1rem;
            }
            
            .form-input, .form-textarea {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="loading" id="loading" role="status" aria-live="polite">페이지를 불러오는 중...</div>
    
    <div id="mainContent" style="display: none;">
        <div id="notification" class="notification" role="alert" aria-live="assertive">
            🙏 감사 기록이 저장되었습니다!
        </div>

        <nav class="nav-menu" role="navigation" aria-label="주 메뉴">
            <a href="#home" class="nav-item" aria-current="page">홈</a>
            <a href="#overview" class="nav-item">개요</a>
            <a href="#how-to" class="nav-item">참여방법</a>
            <a href="#schedule" class="nav-item">일정</a>
            <a href="#share" class="nav-item">감사나눔</a>
        </nav>

        <div class="container">
            <header id="home" class="header">
                <h1 class="title">🍂 감사한달 캠페인</h1>
                
                <div class="countdown">
                    <h2 id="countdownTitle">캠페인 시작까지</h2>
                    <div class="time-boxes" id="timeBoxes">
                        <div class="time-box" role="timer">
                            <span class="time-number" id="days">00</span>
                            <span class="time-label">일</span>
                        </div>
                        <div class="time-box">
                            <span class="time-number" id="hours">00</span>
                            <span class="time-label">시간</span>
                        </div>
                        <div class="time-box">
                            <span class="time-number" id="minutes">00</span>
                            <span class="time-label">분</span>
                        </div>
                        <div class="time-box">
                            <span class="time-number" id="seconds">00</span>
                            <span class="time-label">초</span>
                        </div>
                    </div>
                    <p id="countdownMessage">2025년 10월 20일 시작</p>
                </div>
            </header>

            <section id="overview" class="card">
                <div class="overview-text">
                    <p style="font-size: 1.3rem; color: var(--primary-color); font-weight: 600; margin-bottom: 20px;">
                        "깊어가는 가을, 하나님의 풍성한 은혜가 여러분의 삶에 가득하기를 축복합니다"
                    </p>
                    <p>
                        이번 <strong>'감사한달 캠페인'</strong>을 통해 우리는 "범사에 감사하라"는 귀한 믿음의 훈련을 함께 하고자 합니다. 
                        우리의 형편과 감정에 상관없이, 모든 순간이 하나님의 주권 아래 있음을 믿음으로 고백하며, 
                        작은 감사들이 쌓여 삶을 변화시키는 기적을 경험하게 될 것입니다.
                    </p>
                    <div class="highlight">
                        <p style="color: var(--primary-color); font-weight: 600;">
                            특별히 이번 감사한달 캠페인에는 우리 교회 모든 성도들, 즉 <strong>어린이부, 중고등부를 포함한 온 교회</strong>가 함께 참여하게 됩니다. 
                            온 성도들이 한 마음으로 같은 말씀을 묵상하고 감사 제목을 기록하는 귀한 시간이 되기를 소망합니다.
                        </p>
                    </div>
                    <p style="color: #dc2626; font-weight: 600; margin-top: 20px;">
                        이 캠페인이 우리 모두의 삶이 감사의 고백으로 가득 차는 영적 전환점이 되기를 간절히 바랍니다.
                    </p>
                    <div style="margin-top: 30px; font-style: italic; color: #666;">
                        2025년 10월 어느날, 담임목사 권혁인
                    </div>
                </div>
            </section>

            <section id="how-to" class="card">
                <h2 class="section-title">참여 방법</h2>
                
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>감사 노트 기록</h3>
                        <p>매일 감사의 마음을 기록</p>
                        <ul style="text-align: left; margin-top: 15px;">
                            <li>말씀 묵상 및 암송</li>
                            <li>감사 제목 기록 (2가지 이상)</li>
                            <li>감사 간증 듣기 (QR코드)</li>
                        </ul>
                    </div>

                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>감사 편지 작성</h3>
                        <p>하나님께 드리는 편지</p>
                        <p style="margin-top: 15px;">
                            한 달간의 기록이 끝나면, 노트 25페이지 편지지에 하나님께 드리는 나만의 감사 편지를 작성해 주세요.
                        </p>
                    </div>

                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>노트 제출 및 봉헌</h3>
                        <p>11월 23일 주일</p>
                        <p style="margin-top: 15px;">
                            작성한 감사 노트를 본당 로비 감사 노트 박스에 넣어주세요. 추수감사주일 예배 시 봉헌으로 드립니다.
                        </p>
                    </div>

                    <div class="step">
                        <div class="step-number">4</div>
                        <h3>완료 선물</h3>
                        <p>11월 30일</p>
                        <p style="margin-top: 15px;">
                            기쁨 가득한 감사한달 캠페인을 모두 완수한 분들에게는 작은 선물을 드립니다.
                        </p>
                        <p style="color: var(--primary-color); font-weight: 600; margin-top: 10px;">
                            (제출하신 노트는 선물 수령시 함께 드립니다)
                        </p>
                    </div>
                </div>
            </section>

            <section id="schedule" class="schedule">
                <h2 style="font-size: 2rem; margin-bottom: 20px;">주요 일정</h2>
                <div class="schedule-items">
                    <div class="schedule-item">
                        <div class="schedule-date">10/12</div>
                        <div>노트 배부 (1차)</div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-date">10/19</div>
                        <div>노트 배부 (2차)</div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-date">10/20</div>
                        <div>캠페인 시작</div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-date">11/23</div>
                        <div>노트 제출 및 봉헌<br>(추수감사주일)</div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-date">11/30</div>
                        <div>완료 선물 수령</div>
                    </div>
                </div>
            </section>

            <section style="margin: 30px 0;">
                <div class="info-box">
                    📚 교육부(어린이부, 중고등부) 안내: 감사 노트는 각 부서 담당 교역자 및 교사를 통해 배부됩니다.
                </div>
            </section>

            <section id="share" class="gratitude-form">
                <h3 class="form-title">🙏 감사 나눔 공간</h3>
                <p class="form-subtitle">
                    노트에 쓴 나의 감사제목을 온라인에서 온 성도들과도 함께 나눌수 있어요<br>
                    우리 교회 성도들과 함께 감사를 나누며 서로에게 은혜가 되어요
                </p>
                
                <div style="max-width: 600px; margin: 0 auto;">
                    <div class="form-group">
                        <label for="userName" class="form-label">이름 (선택사항)</label>
                        <input type="text" id="userName" class="form-input" placeholder="이름을 입력하거나 비워두면 '익명'으로 표시됩니다" maxlength="50">
                    </div>
                    
                    <div class="form-group">
                        <label for="gratitudeText" class="form-label">💕 오늘의 감사</label>
                        <textarea id="gratitudeText" class="form-textarea" placeholder="오늘 하루 하나님께서 행하신 일을 기록해보세요..." maxlength="500"></textarea>
                    </div>
                    
                    <button onclick="App.saveGratitude()" class="submit-btn" aria-label="감사 제목 제출">
                        🌟 감사 나누기
                    </button>
                </div>
            </section>

            <section class="shared-section">
                <h3 style="font-size: 2rem; text-align: center; margin-bottom: 20px;">💝 함께하는 감사들</h3>
                <p style="text-align: center; opacity: 0.9; margin-bottom: 30px;">우리 교회 성도들이 나눈 감사의 이야기들</p>
                
                <div id="gratitudeList" class="gratitude-list">
                    <div style="text-align: center; padding: 40px; opacity: 0.8;">
                        <p style="font-size: 1.3rem;">🌟 첫 번째 감사를 나누어 주세요!</p>
                        <p style="margin-top: 10px;">여러분의 감사가 다른 성도들에게 큰 은혜가 됩니다</p>
                    </div>
                </div>
                <button id="loadMore" class="load-more-btn" style="display: none;" aria-label="더 많은 감사 보기">더 보기</button>
            </section>
        </div>

        <footer class="footer">
            <p class="footer-verse">"범사에 감사하라 이것이 그리스도 예수 안에서 너희를 향하신 하나님의 뜻이니라"</p>
            <p style="font-size: 0.9rem; opacity: 0.7; margin-bottom: 20px;">데살로니가전서 5:18</p>
            <p>감사한달 캠페인과 함께 하나님의 은혜를 경험하세요</p>
            <div style="background: var(--primary-color); color: white; padding: 12px 24px; border-radius: var(--border-radius); margin-top: 20px; display: inline-block;">
                ✝️ 산타클라라연합감리교회
            </div>
        </footer>
    </div>

    <script>
        const App = {
            gratitudes: [
                {
                    id: 1728259200000,
                    name: '김은혜',
                    text: '오늘 아침 기도 시간에 하나님께서 주신 평안함에 감사드립니다. 바쁜 일상 속에서도 잠시 멈춰 서서 주님과 교제할 수 있는 시간이 있어서 너무 감사해요. 그리고 가족들이 모두 건강하게 하루를 시작할 수 있게 해주셔서 감사합니다.',
                    date: '2025. 10. 7.',
                    time: '09:30',
                    likes: 3
                },
                {
                    id: 1728262800000,
                    name: '박믿음',
                    text: '어려운 상황 가운데서도 함께 기도해주시는 교회 성도님들이 있어서 감사합니다. 혼자가 아니라는 것을 느낄 때마다 하나님의 사랑을 경험하게 됩니다. 오늘도 작은 일상의 기쁨들 - 따뜻한 햇살, 맛있는 식사, 가족의 웃음소리에 감사드려요.',
                    date: '2025. 10. 7.',
                    time: '14:20',
                    likes: 5
                }
            ],
            pageSize: 10,
            currentPage: 1,
            isLoaded: false,

            // 입력 데이터 sanitization
            sanitizeInput(input) {
                const div = document.createElement('div');
                div.textContent = input;
                return div.innerHTML.replace(/[<>&"]/g, (c) => ({
                    '<': '&lt;',
                    '>': '&gt;',
                    '&': '&amp;',
                    '"': '&quot;'
                })[c]);
            },

            initializePage() {
                try {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('mainContent').style.display = 'block';
                    
                    this.loadData();
                    this.updateCountdown();
                    setInterval(() => this.updateCountdown(), 1000);
                    this.updateActiveNav();
                    this.addEventListeners();
                    
                    this.isLoaded = true;
                } catch (error) {
                    console.log('초기화 오류:', error);
                    setTimeout(() => this.initializePage(), 1000);
                }
            },

            loadData() {
                try {
                    const saved = localStorage.getItem('gratitudes');
                    if (saved) {
                        this.gratitudes = JSON.parse(saved);
                    }
                    this.showGratitudes();
                } catch (e) {
                    this.gratitudes = [];
                    this.showGratitudes();
                }
            },

            saveData() {
                try {
                    localStorage.setItem('gratitudes', JSON.stringify(this.gratitudes));
                } catch (e) {
                    console.log('저장 실패:', e);
                }
            },

            updateCountdown() {
                try {
                    const start = new Date('2025-10-20T00:00:00');
                    const now = new Date();
                    const diff = start - now;
                    
                    const daysEl = document.getElementById('days');
                    const hoursEl = document.getElementById('hours');
                    const minutesEl = document.getElementById('minutes');
                    const secondsEl = document.getElementById('seconds');
                    const titleEl = document.getElementById('countdownTitle');
                    const boxesEl = document.getElementById('timeBoxes');
                    
                    if (diff > 0) {
                        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                        
                        if (daysEl && daysEl.textContent !== String(days).padStart(2, '0')) daysEl.textContent = String(days).padStart(2, '0');
                        if (hoursEl && hoursEl.textContent !== String(hours).padStart(2, '0')) hoursEl.textContent = String(hours).padStart(2, '0');
                        if (minutesEl && minutesEl.textContent !== String(minutes).padStart(2, '0')) minutesEl.textContent = String(minutes).padStart(2, '0');
                        if (secondsEl && secondsEl.textContent !== String(seconds).padStart(2, '0')) secondsEl.textContent = String(seconds).padStart(2, '0');
                    } else {
                        if (titleEl) titleEl.textContent = '캠페인이 시작되었습니다!';
                        if (boxesEl) {
                            boxesEl.innerHTML = '<div style="background: var(--accent-color); color: white; padding: 20px; border-radius: var(--border-radius); text-align: center; width: 100%;"><div style="font-size: 1.5rem; font-weight: bold;">🎉 캠페인 진행 중 🎉</div><div style="margin-top: 10px;">매일 감사를 기록해보세요</div></div>';
                        }
                    }
                } catch (error) {
                    console.log('카운트다운 오류:', error);
                }
            },

            saveGratitude() {
                try {
                    const nameEl = document.getElementById('userName');
                    const textEl = document.getElementById('gratitudeText');
                    
                    if (!nameEl || !textEl) return;
                    
                    const name = this.sanitizeInput(nameEl.value.trim()) || '익명';
                    const text = this.sanitizeInput(textEl.value.trim());
                    
                    if (!text) {
                        alert('감사 제목을 입력해주세요.');
                        return;
                    }
                    
                    const newGratitude = {
                        id: Date.now(),
                        name: name.slice(0, 50),
                        text: text.slice(0, 500),
                        date: new Date().toLocaleDateString('ko-KR'),
                        time: new Date().toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'}),
                        likes: 0
                    };
                    
                    this.gratitudes.unshift(newGratitude);
                    this.currentPage = 1;
                    this.saveData();
                    
                    nameEl.value = '';
                    textEl.value = '';
                    
                    this.showGratitudes();
                    this.showNotification();
                } catch (error) {
                    console.log('저장 오류:', error);
                }
            },

            toggleLike(id) {
                try {
                    const gratitude = this.gratitudes.find(g => g.id === id);
                    if (gratitude) {
                        gratitude.likes = (gratitude.likes || 0) + 1;
                        this.saveData();
                        this.showGratitudes();
                    }
                } catch (error) {
                    console.log('좋아요 오류:', error);
                }
            },

            showGratitudes() {
                try {
                    const list = document.getElementById('gratitudeList');
                    const loadMoreBtn = document.getElementById('loadMore');
                    if (!list) return;
                    
                    if (this.gratitudes.length === 0) {
                        list.innerHTML = '<div style="text-align: center; padding: 40px; opacity: 0.8;"><p style="font-size: 1.3rem;">🌟 첫 번째 감사를 나누어 주세요!</p><p style="margin-top: 10px;">여러분의 감사가 다른 성도들에게 큰 은혜가 됩니다</p></div>';
                        if (loadMoreBtn) loadMoreBtn.style.display = 'none';
                        return;
                    }
                    
                    const start = (this.currentPage - 1) * this.pageSize;
                    const end = start + this.pageSize;
                    const paginatedGratitudes = this.gratitudes.slice(0, end);
                    
                    list.innerHTML = paginatedGratitudes.map(g => `
                        <div class="gratitude-item" role="article">
                            <div class="gratitude-header">
                                <div class="avatar" aria-hidden="true">${g.name.charAt(0).toUpperCase()}</div>
                                <div>
                                    <div class="user-name">${g.name}</div>
                                    <div style="font-size: 0.9rem; color: #666;">${g.date}</div>
                                </div>
                            </div>
                            <div class="gratitude-text">${g.text}</div>
                            <div class="gratitude-footer">
                                <button onclick="App.toggleLike(${g.id})" class="like-btn" aria-label="${g.name}의 감사에 좋아요 추가">
                                    ❤️ ${g.likes || 0}
                                </button>
                                <span>${g.time}</span>
                            </div>
                        </div>
                    `).join('');
                    
                    loadMoreBtn.style.display = end < this.gratitudes.length ? 'block' : 'none';
                } catch (error) {
                    console.log('표시 오류:', error);
                }
            },

            loadMoreGratitudes() {
                this.currentPage++;
                this.showGratitudes();
            },

            showNotification() {
                try {
                    const notification = document.getElementById('notification');
                    if (notification) {
                        notification.classList.add('show');
                        setTimeout(() => {
                            notification.classList.remove('show');
                        }, 3000);
                    }
                } catch (error) {
                    console.log('알림 오류:', error);
                }
            },

            updateActiveNav() {
                try {
                    const sections = ['home', 'overview', 'how-to', 'schedule', 'share'];
                    const navItems = document.querySelectorAll('.nav-item');
                    
                    let currentSection = '';
                    
                    sections.forEach(sectionId => {
                        const element = document.getElementById(sectionId);
                        if (element) {
                            const rect = element.getBoundingClientRect();
                            if (rect.top <= 100 && rect.bottom >= 100) {
                                currentSection = sectionId;
                            }
                        }
                    });
                    
                    navItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('href') === '#' + currentSection) {
                            item.classList.add('active');
                            item.setAttribute('aria-current', 'page');
                        } else {
                            item.removeAttribute('aria-current');
                        }
                    });
                } catch (error) {
                    console.log('네비게이션 오류:', error);
                }
            },

            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },

            addEventListeners() {
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('nav-item')) {
                        e.preventDefault();
                        const targetId = e.target.getAttribute('href').substring(1);
                        const targetElement = document.getElementById(targetId);
                        
                        if (targetElement) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                });

                document.getElementById('loadMore')?.addEventListener('click', () => this.loadMoreGratitudes());

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && e.target.classList.contains('submit-btn')) {
                        this.saveGratitude();
                    }
                });

                window.addEventListener('scroll', this.debounce(() => this.updateActiveNav(), 100));
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => App.initializePage(), 100);
        });

        if (document.readyState !== 'loading') {
            setTimeout(() => App.initializePage(), 100);
        }
    </script>
</body>
</html>